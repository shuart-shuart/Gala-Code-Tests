<!DOCTYPE html>
<html>
<head>
  <title>Top Three Highest Bidding Prices</title>
</head>
<body>
  <h2>Top Three Highest Bidding Prices</h2>
  <table id="topPricesTable">
    <thead>
      <tr>
        <th>Rank</th>
        <th>Bidding Price (S$)</th>
      </tr>
    </thead>
    <tbody id="dataBody"></tbody>
  </table>

  <script>
    async function fetchTopThreePrices() {
      const url = 'https://spreadsheets.google.com/feeds/cells/1xiEQYGnKEHZmgLAZv8zyBfl_5CVrbrD4cdcs3x0-FY0/1/public/full?alt=json';
      const response = await fetch(url);
      const data = await response.json();

      const entries = data.feed.entry;
      const prices = [];

      for (let i = 1; i < entries.length; i += 2) {
        prices.push(parseFloat(entries[i].content.$t));
      }

      const sortedPrices = prices.sort((a, b) => b - a);
      const topThreePrices = sortedPrices.slice(0, 3);

      const tableBody = document.getElementById('dataBody');

      topThreePrices.forEach((price, index) => {
        const newRow = tableBody.insertRow();
        const rankCell = newRow.insertCell();
        const priceCell = newRow.insertCell();

        rankCell.textContent = index + 1;
        priceCell.textContent = price.toFixed(2);
      });
    }

    fetchTopThreePrices();
  </script>
</body>
</html>
