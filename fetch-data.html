<!DOCTYPE html>
<html>
<head>
  <title>Top Three Highest Bidding Prices</title>
</head>
<body>
  <h2>Top Three Highest Bidding Prices</h2>
  <table id="topPricesTable">
    <thead>
      <tr>
        <th>Rank</th>
        <th>Bidding Price (S$)</th>
      </tr>
    </thead>
    <tbody id="dataBody"></tbody>
  </table>

  <script>
    async function fetchTopThreePrices() {
      const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR8DRxhvIYdC4CnO3zk-kH3fjcd0af6Hgxd5WF97-AzWGe15wBA8IVRUClTSGBPc1hKCMi49AKaH1Y5/pub?gid=0&single=true&output=csv';
      const response = await fetch(url);
      const csvData = await response.text();

      const rows = csvData.split('\n');
      const prices = [];

      for (let i = 1; i < rows.length; i++) {
        const columns = rows[i].split(',');
        if (columns.length >= 2) {
          prices.push(parseFloat(columns[1]));
        }
      }

      const sortedPrices = prices.sort((a, b) => b - a);
      const topThreePrices = sortedPrices.slice(0, 3);

      const tableBody = document.getElementById('dataBody');

      topThreePrices.forEach((price, index) => {
        const newRow = tableBody.insertRow();
        const rankCell = newRow.insertCell();
        const priceCell = newRow.insertCell();

        rankCell.textContent = index + 1;
        priceCell.textContent = price.toFixed(2);
      });
    }

    fetchTopThreePrices();
  </script>
</body>
</html>
